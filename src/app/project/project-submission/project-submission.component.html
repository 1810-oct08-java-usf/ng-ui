<app-navbar></app-navbar>
 <div class="my-theme">
    <h1 id="title">Submit a Project</h1>
    <form  #projectForm="ngForm" novalidate>
        <table class="example-full-width" cellspacing="5"><tr fxLayout="row wrap">
          <td fxFlex="50%" fxFlex.md="50%" fxFlex.sm="50%" fxFlex.xs="100%">
              <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Project Name</mat-label>
                  <mat-error *ngIf="!name.valid || name.pristine">Project name is required</mat-error>
                  <input id="project_name" name="projectName" type="text" matInput placeholder="Project Name" [(ngModel)]="projectToUpload.name"
                  [ngModelOptions]="{standalone: true}" required #name="ngModel">
                </mat-form-field>
          </td>
          <td fxFlex="50%" fxFlex.md="50%" fxFlex.sm="50%" fxFlex.xs="100%">
              <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Batch Name</mat-label>
                  <mat-error *ngIf="!batch.valid || batch.pristine">Batch name is required</mat-error>
                  <input type="text" name="batchName" matInput placeholder="Batch Name" [(ngModel)]="projectToUpload.batch"
                  [ngModelOptions]="{standalone: true}" required #batch="ngModel">
                </mat-form-field>
          </td>
        </tr></table>


        <table class="example-full-width" cellspacing="5">
          <tr fxLayout="row wrap">
             <td fxFlex="50%" fxFlex.md="50%" fxFlex.sm="50%" fxFlex.xs="100%">
                 <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>Trainer Name</mat-label>
                    <mat-error *ngIf="!trainerName.valid || trainerName.pristine">Trainer name is required</mat-error>
                    <!-- TODO: make this a dropdown where it lists all of the trainers -->
                    <input type="text" name="trainers" matInput placeholder="Trainer Name"
                    [(ngModel)]="projectToUpload.trainer"
                    [ngModelOptions]="{standalone: true}" required #trainerName="ngModel">
                    <!-- [disabled]="(user.role !== 'ROLE_ADMIN')" -->
                  </mat-form-field>
                </td>
                <td fxFlex="50%" fxFlex.md="50%" fxFlex.sm="50%" fxFlex.xs="100%">
                <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>Group Members</mat-label>
                    <mat-error *ngIf="!groupMembers.valid || groupMembers.pristine">Group members are required</mat-error>
                  <input type="text" id="inputGroupMembers" matInput name="groupMembers" placeholder="Group Members" readonly [(ngModel)]="groupMemberString"
                    [ngModelOptions]="{standalone: true}" (click)="openEditableDialog($event)" required #groupMembers="ngModel">
                    <!--<mat-hint id="editGroupMembers" (click)="openEditDialog($event)" aria-label="editGroupMembers" name="editGroupMembers" align="end">Edit</mat-hint>-->
                  </mat-form-field>
            </td>
          </tr>
        </table>

        <table class="example-full-width" cellspacing="5"><tr>
          <td>
                <mat-form-field class="example-full-width"  appearance="outline">
                        <mat-label>Description</mat-label>
                    <mat-error *ngIf="!description.valid || description.pristine">Description is required</mat-error>
                    <textarea matInput name="description" placeholder="Project Description" [(ngModel)]="projectToUpload.description"
                    [ngModelOptions]="{standalone: true}" #description="ngModel" required></textarea>
                  </mat-form-field>
            </td>
        </tr></table>

        <table class="example-full-width" cellspacing="5">
          <tr fxLayout="row wrap">
            <td fxFlex="50%" fxFlex.md="50%" fxFlex.sm="50%" fxFlex.xs="100%">
                  <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>Repository Links</mat-label>
                      <mat-error *ngIf="!zipLinks.valid || zipLinks.pristine || invalidLink">A Github link is required in format: https://github.com/[Github username]/[Repository Name]</mat-error>
                      <textarea type="text" id="inputGithubLink" name="repoLinks" readonly matInput placeholder="Project Repository Links" [(ngModel)]="zipLinksString"
                      [ngModelOptions]="{standalone: true}" (click)="openEditableDialog($event)" #zipLinks="ngModel" required></textarea>
                      <!--<mat-hint id="editGithubLink" (click)="openEditDialog($event)" aria-label="editGithubLink" name="editGithubLink" align="end">Edit</mat-hint>-->
                    </mat-form-field>
              </td>
              <td fxFlex="50%" fxFlex.md="50%" fxFlex.sm="50%" fxFlex.xs="100%">
                <!-- <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Technology Stack</mat-label>
                  <mat-error *ngIf="!techStack.valid || techStack.pristine">Technology stack is required</mat-error>
                  <input type=text matInput name="stack" placeholder="Project Technology Stack" [(ngModel)]="projectToUpload.techStack"
                  [ngModelOptions]="{standalone: true}" required #techStack="ngModel">
                </mat-form-field> -->
                <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Technology Stack</mat-label>
                    <mat-error *ngIf="!techStack.valid || techStack.pristine">Technology stack is required</mat-error>
                    <mat-select 
                    placeholder="Select Batch" 
                    [(ngModel)]="projectToUpload.techStack"
                    [ngModelOptions]="{standalone: true}" 
                    required #techStack="ngModel">
                      <mat-option *ngFor="let tech of techStackList" [value]="tech">
                        {{tech}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
              </td>
            </tr>
          </table>

          <table class="example-full-width" cellspacing="5">
              <tr>
                <td>
                    <span id="requiredScreenShotButton">* </span>
                    <!-- This button triggers the file input to be clicked by referencing its template variable, uploadScreenshots -->
                    <button id="buttonScreenshotTrigger" mat-flat-button color="accent" (click)="uploadScreenshots.click()">Choose Project Screenshots: </button>
                    <span *ngFor="let screenshot of projectToUpload.screenShots">
                        <span> {{ screenshot.name }} </span>
                    </span>
                </td>
              </tr>
            </table>
            <br>

            <table class="example-full-width" cellspacing="5">
              <tr>
                <td>
                    <span id="requiredDataModelButton">* </span>
                    <!-- This button triggers the file input to be clicked by referencing its template variable, uploadDatamodel -->
                    <button id="buttonDatamodelTrigger" mat-flat-button color="accent" (click)="uploadDatamodel.click()">Choose Data Model: </button>
                    <span *ngFor="let datamodel of projectToUpload.dataModel">
                        <span> {{ datamodel.name }} </span>
                    </span>
                </td>
              </tr>
            </table>
            <br>

           <button [disabled] = "submitting" (click)="submitForm()" [disabled]="(!name.valid || name.pristine) || (!batch.valid || batch.pristine) || (!trainerName.valid) ||
           (!groupMembers.valid) || (!description.valid || description.pristine) || (!zipLinks.valid) ||
           (!techStack.valid || techStack.pristine) || !validScreenshots || !validGithubURL || !validDatamodel" type="submit" id="submit" mat-flat-button color="accent">Submit Project</button>

           <br *ngIf='submitting'>
           <br *ngIf='submitting'>
           <br *ngIf='submitting'>
           <div id="registerSpinner" *ngIf='submitting'>
             <div id="aao">
             <mat-spinner [diameter]="30"></mat-spinner><br>
             <span>Submitting</span>
             </div>
            </div>

           <br>
           <br>

           <!-- Hidden file input used to retrieve project screenshots -->
           <input id="screenShots" name="screenShotFiles" #uploadScreenshots hidden type="file" (change)="onFileSelected($event)" accept="image/*" multiple required/>
           <!-- Hidden file input used to retrieve project data models-->
           <input id="dataModel" name="dataModelFiles" #uploadDatamodel hidden type="file" (change)="onDataModelSelected($event)" accept=".sql" />
      </form>
 </div>
